<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
    <link rel="stylesheet" href="/custom.css">
    <link rel="icon" type="image/svg" href="/assets/logo.svg">
        <title>Build a website</title>
                    <meta name="description" content="Build a website">
              <meta name="author" content="Miller Arlindo Hall (hall@hey.com)">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>
    <header>
      <h1>Miller Hall</h1>
      <nav>
        <a href="/">home</a>
        <a href="/wiki.html">wiki</a>
        <a href="/posts.html">posts</a>
        <a href="https://twitter.com/arlindohall">twitter</a>
      </nav>
    </header>
    <main>
            <p class="light-text">November 13, 2021</p>
      <!--
  Indentation is messed up here because pandoc indents code blocks
  if they are indented with the content.
-->
<h1 id="build-a-website-with-pandoc-and-github-pages">Build a website with <code>pandoc</code> and GitHub pages</h1>
<p>GitHub pages is an awesome tool for building a website. If you don’t set up any themes or configure jekyll to transform markdown, you can still have a pretty easy setup and automation. I’ve set up this website using Amazon Route53, GitHub pages, and <code>pandoc</code> with GitHub actions.</p>
<p>Pages hosts the site at <a href="https://arlindohall.github.io" class="uri">https://arlindohall.github.io</a>, but I wanted to use a custom domain, so I used GitHub pages’ <a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/about-custom-domains-and-github-pages">built-in support for custom domains</a>.</p>
<p>When I first set up the website, I built the HTML by hand, but I quickly realized that I was re-using huge chunks of HTML for each page. At that point I tried to use CommonMark JS to compile the markdown pages into HTML, which gave me anchor links and other cool features, but I didn’t like the build process, so I kept looking.</p>
<p>I’ve used <code>pandoc</code> in the past to build PDF documents and slides, so I gave it a try and found that by using a template I could get almost all of the functionality I wanted. On top of that, by using a few plugins and a tiny bit of javascript, I was able to get a fully static, performant, and accessible website using the following steps.</p>
<h2 id="pandoc-actions">Pandoc actions</h2>
<p>The script <a href="https://github.com/arlindohall/arlindohall.github.io/blob/main/compile.sh">compile.sh</a> reads the files in <code>_posts</code> and <code>_root</code>, (which get ignored by pages) and compiles them with pandoc into HTML, with the output directories of <code>posts</code> and <code>/</code> respectively.</p>
<p>The script gets run by GitHub actions after installing <code>pandoc</code> (you have to run apt as root to install in actions). Then I use GitHub actions’ push functionality to commit the changes back to the repo. This way I only have to write markdown and then the HTML gets auto-generated by actions.</p>
<h2 id="anchor-links">Anchor Links</h2>
<p>I think anchor links are a really important feature for a mostly-text website like this one. I used pandoc because it gave me accessibility by producing vanilla HTML instead of using javascript or especially a JS framework. That said, I looked and looked for a native pandoc feature that would generate anchor links for each header and just couldn’t find one. I noticed that <code>pandoc</code>’s own manual is generated with <code>pandoc</code>, and it has anchor links, but best I can tell they use a custom Haskell plugin to do that. I also found the following links to google groups discussions of people trying to do the same thing.</p>
<ul>
<li><a href="https://web.archive.org/web/20211113193720/https://groups.google.com/g/pandoc-discuss/c/7Lx6jIYZgJY">https://groups.google.com/g/pandoc-discuss…</a></li>
<li><a href="https://web.archive.org/web/20211113193701/https://groups.google.com/g/pandoc-discuss/c/F-X7FiRah8c?pli=1">https://groups.google.com/g/pandoc-discuss…</a></li>
</ul>
<p>Since anchor links already aren’t going to be as useful to a browser like lynx or a screen reader, I figured it would be an okay shortcut to use javascript for these, which I did by just adding it to the template.</p>
<p>This website is a work in progress. If you have any thoughts about this feel free to share on the repo (you can find the link to the source of any page in the footer)!</p>
    </main>
    <footer>
      <img class="index-personal-logo"
          title="Personal logo"
          alt="Personal website logo, a monogram of MAH, my initials"
          style="height: 40px;"
          src="/assets/logo.svg">
      </img>

      <p>Page source on GitHub:
        (<a href="https://github.com/arlindohall/arlindohall.github.io/blob/mainline/posts/build-a-website-with-pandoc-and-pages.html">html</a>,
        <a href="https://github.com/arlindohall/arlindohall.github.io/blob/mainline/_posts/build-a-website-with-pandoc-and-pages.md">md</a>)
      </p>
    </footer>
  </body>
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      let headers = document.querySelectorAll("h1,h2,h3,h4");
      for (let h of headers) {
        let content = h.textContent;
        let id = '#' + h.id;
        let a = document.createElement('a');

        a.setAttribute('href', id);
        a.textContent = content;

        h.textContent = '';
        h.appendChild(a);
      }
    });
  </script>
</html>
